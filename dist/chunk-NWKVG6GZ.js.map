{"version":3,"sources":["../src/components/DataTable.tsx"],"sourcesContent":["import React, { useState, useMemo } from 'react';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n  Button,\n  Badge,\n  cn\n} from '@andrea/crm-ui';\n\n/**\n * Column definition for DataTable\n */\nexport interface DataTableColumn<T = any> {\n  key: string;\n  title: string;\n  dataIndex?: string;\n  render?: (value: any, record: T, index: number) => React.ReactNode;\n  sortable?: boolean;\n  filterable?: boolean;\n  width?: string | number;\n  align?: 'left' | 'center' | 'right';\n  className?: string;\n}\n\n/**\n * Sort configuration\n */\nexport interface SortConfig {\n  key: string;\n  direction: 'asc' | 'desc';\n}\n\n/**\n * Filter configuration\n */\nexport interface FilterConfig {\n  [key: string]: any;\n}\n\n/**\n * DataTable props\n */\nexport interface DataTableProps<T = any> {\n  data: T[];\n  columns: DataTableColumn<T>[];\n  loading?: boolean;\n  pagination?: {\n    current: number;\n    pageSize: number;\n    total: number;\n    onChange: (page: number, pageSize: number) => void;\n  };\n  rowSelection?: {\n    selectedRowKeys: (string | number)[];\n    onChange: (selectedRowKeys: (string | number)[], selectedRows: T[]) => void;\n  };\n  onSort?: (sortConfig: SortConfig | null) => void;\n  onFilter?: (filters: FilterConfig) => void;\n  onRowClick?: (record: T, index: number) => void;\n  rowKey?: string | ((record: T) => string | number);\n  className?: string;\n  emptyText?: string;\n  size?: 'small' | 'medium' | 'large';\n}\n\n/**\n * Professional DataTable component\n * Combines the best features from crm_demo, tracc, and scheduler_demo\n */\nexport function DataTable<T = any>({\n  data,\n  columns,\n  loading = false,\n  pagination,\n  rowSelection,\n  onSort,\n  onFilter,\n  onRowClick,\n  rowKey = 'id',\n  className,\n  emptyText = 'No data available',\n  size = 'medium'\n}: DataTableProps<T>) {\n  const [sortConfig, setSortConfig] = useState<SortConfig | null>(null);\n  const [filters, setFilters] = useState<FilterConfig>({});\n\n  // Get row key\n  const getRowKey = (record: T, index: number): string | number => {\n    if (typeof rowKey === 'function') {\n      return rowKey(record);\n    }\n    return (record as any)[rowKey] || index;\n  };\n\n  // Handle sort\n  const handleSort = (column: DataTableColumn<T>) => {\n    if (!column.sortable) return;\n\n    let newSortConfig: SortConfig | null = null;\n\n    if (!sortConfig || sortConfig.key !== column.key) {\n      newSortConfig = { key: column.key, direction: 'asc' };\n    } else if (sortConfig.direction === 'asc') {\n      newSortConfig = { key: column.key, direction: 'desc' };\n    } else {\n      newSortConfig = null;\n    }\n\n    setSortConfig(newSortConfig);\n    onSort?.(newSortConfig);\n  };\n\n  // Handle row selection\n  const handleRowSelect = (record: T, selected: boolean) => {\n    if (!rowSelection) return;\n\n    const key = getRowKey(record, 0);\n    const { selectedRowKeys, onChange } = rowSelection;\n\n    let newSelectedKeys: (string | number)[];\n    if (selected) {\n      newSelectedKeys = [...selectedRowKeys, key];\n    } else {\n      newSelectedKeys = selectedRowKeys.filter(k => k !== key);\n    }\n\n    const selectedRows = data.filter(item => \n      newSelectedKeys.includes(getRowKey(item, 0))\n    );\n\n    onChange(newSelectedKeys, selectedRows);\n  };\n\n  // Handle select all\n  const handleSelectAll = (selected: boolean) => {\n    if (!rowSelection) return;\n\n    const { onChange } = rowSelection;\n    \n    if (selected) {\n      const allKeys = data.map((item, index) => getRowKey(item, index));\n      onChange(allKeys, data);\n    } else {\n      onChange([], []);\n    }\n  };\n\n  // Check if all rows are selected\n  const isAllSelected = useMemo(() => {\n    if (!rowSelection || data.length === 0) return false;\n    return data.every((item, index) => \n      rowSelection.selectedRowKeys.includes(getRowKey(item, index))\n    );\n  }, [rowSelection?.selectedRowKeys, data, rowKey]);\n\n  // Check if some rows are selected\n  const isSomeSelected = useMemo(() => {\n    if (!rowSelection || data.length === 0) return false;\n    return rowSelection.selectedRowKeys.length > 0 && !isAllSelected;\n  }, [rowSelection?.selectedRowKeys, data, isAllSelected]);\n\n  // Render cell content\n  const renderCell = (column: DataTableColumn<T>, record: T, index: number) => {\n    const value = column.dataIndex ? (record as any)[column.dataIndex] : record;\n    \n    if (column.render) {\n      return column.render(value, record, index);\n    }\n\n    // Default rendering for common types\n    if (typeof value === 'boolean') {\n      return (\n        <Badge variant={value ? 'default' : 'secondary'}>\n          {value ? 'Yes' : 'No'}\n        </Badge>\n      );\n    }\n\n    if (value === null || value === undefined) {\n      return <span className=\"text-muted-foreground\">—</span>;\n    }\n\n    return String(value);\n  };\n\n  // Size classes\n  const sizeClasses = {\n    small: 'text-xs',\n    medium: 'text-sm',\n    large: 'text-base'\n  };\n\n  const cellPaddingClasses = {\n    small: 'px-2 py-1',\n    medium: 'px-3 py-2',\n    large: 'px-4 py-3'\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  if (data.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"text-muted-foreground\">{emptyText}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={cn('w-full', className)}>\n      <Table className={sizeClasses[size]}>\n        <TableHeader>\n          <TableRow>\n            {rowSelection && (\n              <TableHead className={cellPaddingClasses[size]}>\n                <input\n                  type=\"checkbox\"\n                  checked={isAllSelected}\n                  ref={input => {\n                    if (input) input.indeterminate = isSomeSelected;\n                  }}\n                  onChange={(e) => handleSelectAll(e.target.checked)}\n                  className=\"rounded border-border\"\n                />\n              </TableHead>\n            )}\n            {columns.map((column) => (\n              <TableHead\n                key={column.key}\n                className={cn(\n                  cellPaddingClasses[size],\n                  column.sortable && 'cursor-pointer hover:bg-muted/50',\n                  column.align === 'center' && 'text-center',\n                  column.align === 'right' && 'text-right',\n                  column.className\n                )}\n                style={{ width: column.width }}\n                onClick={() => handleSort(column)}\n              >\n                <div className=\"flex items-center gap-2\">\n                  {column.title}\n                  {column.sortable && sortConfig?.key === column.key && (\n                    <span className=\"text-xs\">\n                      {sortConfig.direction === 'asc' ? '↑' : '↓'}\n                    </span>\n                  )}\n                </div>\n              </TableHead>\n            ))}\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {data.map((record, index) => {\n            const key = getRowKey(record, index);\n            const isSelected = rowSelection?.selectedRowKeys.includes(key) || false;\n\n            return (\n              <TableRow\n                key={key}\n                className={cn(\n                  onRowClick && 'cursor-pointer',\n                  isSelected && 'bg-muted/50'\n                )}\n                onClick={() => onRowClick?.(record, index)}\n              >\n                {rowSelection && (\n                  <TableCell className={cellPaddingClasses[size]}>\n                    <input\n                      type=\"checkbox\"\n                      checked={isSelected}\n                      onChange={(e) => handleRowSelect(record, e.target.checked)}\n                      onClick={(e) => e.stopPropagation()}\n                      className=\"rounded border-border\"\n                    />\n                  </TableCell>\n                )}\n                {columns.map((column) => (\n                  <TableCell\n                    key={column.key}\n                    className={cn(\n                      cellPaddingClasses[size],\n                      column.align === 'center' && 'text-center',\n                      column.align === 'right' && 'text-right',\n                      column.className\n                    )}\n                  >\n                    {renderCell(column, record, index)}\n                  </TableCell>\n                ))}\n              </TableRow>\n            );\n          })}\n        </TableBody>\n      </Table>\n\n      {pagination && (\n        <div className=\"flex items-center justify-between px-2 py-4\">\n          <div className=\"text-sm text-muted-foreground\">\n            Showing {((pagination.current - 1) * pagination.pageSize) + 1} to{' '}\n            {Math.min(pagination.current * pagination.pageSize, pagination.total)} of{' '}\n            {pagination.total} entries\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => pagination.onChange(pagination.current - 1, pagination.pageSize)}\n              disabled={pagination.current <= 1}\n            >\n              Previous\n            </Button>\n            <span className=\"text-sm\">\n              Page {pagination.current} of {Math.ceil(pagination.total / pagination.pageSize)}\n            </span>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => pagination.onChange(pagination.current + 1, pagination.pageSize)}\n              disabled={pagination.current >= Math.ceil(pagination.total / pagination.pageSize)}\n            >\n              Next\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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","names":[]}